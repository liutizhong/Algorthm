/*ygIndex.js*/var ygIndex={    screenH:$(window).height(),    imgNum:null,//获取加载图片容器    atrrV:undefined,//设置懒加载的图片地址    ygIndexF:null,    ygScrollV:true,//判断滚动时上次加载图片完成    swiperLoad:0,    initLoad:function(imgW,atrrN){//默认加载一屏的图片        $('#ygIndexTopS').val('');//默认清空搜索框        ygIndexF=this;        ygIndexF.imgNum=$(imgW).find('img');        ygIndexF.atrrV=atrrN;        ygIndexF.getImgList(ygIndexF.imgNum,ygIndexF.screenH);    },    scrollF:function(){//侦听滚动事件        window.addEventListener('scroll',function(){            ygIndexF.scrollGet();            var scrollVv=$(window).scrollTop();            var getHeight=scrollVv+ygIndexF.screenH;            if(ygIndex.ygScrollV){                ygIndexF.getImgList(ygIndexF.imgNum,getHeight);            }        },false)    },    getImgList:function(ygIndexImgNum,heightV){//获取加载图片地址        var imageArr=[];        var scrollVv=$(window).scrollTop();        if(scrollVv!=0){            heightV=scrollVv+ygIndexF.screenH;        }        for(var i=0;i<ygIndexImgNum.length;i++){            var currentE=ygIndexImgNum.eq(i);            if(currentE.hasClass('SwiperImg')){                var offsetTop=$('.SwiperImg').eq(0).offset().top;            }else{                var offsetTop=currentE.offset().top;            }            if(offsetTop<=heightV && currentE.attr(ygIndexF.atrrV)){                var lazySrc=currentE.attr(ygIndexF.atrrV);                var lazyImg=new Image();                var imgC='imgC'+i;                lazyImg.src=lazySrc;                currentE.addClass(imgC);                imageArr.push(lazySrc+'|'+imgC);            }        }        var imageCounts=imageArr.length;        var imageI=0;        if(imageArr.length!=0){            ygIndexF.loadImage(imageI,imageArr,imageCounts);        }    },    loadImage:function(imageIn,imageArrC,imageArrL,callback){        var ygIndexImgNum=ygIndexF.imgNum;        var imageIndex=imageIn;        if(imageIndex<imageArrL){            // var currentEl=ygIndexImgNum.eq(imageIn);            var img = new Image();            var lazySrcW=imageArrC[imageIn];            var lazySrcWW=lazySrcW.split('|');            var lazySrc=lazySrcWW[0];            var lazyClass=lazySrcWW[1];            img.src = lazySrc;            img.onload = function(){                img.onload = null;                var ele='.'+lazyClass;                var domElement=$(ele).parents('a.linkRe');                ygIndexF.indexLink(domElement);                ygIndexF.IndexImg(ele);                $(ele).attr('src',lazySrc).removeAttr(ygIndexF.atrrV).removeClass(lazyClass);                //console.log(lazySrc+'---'+lazyClass);                imagesIndexF();            }            img.onerror = function(){                  imagesIndexF();            }            function imagesIndexF(){                imageIndex++;                if(imageIndex<imageArrL){                    ygIndexF.loadImage(imageIndex,imageArrC,imageArrL);                    ygIndex.ygScrollV=false;                }else{                    ygIndex.ygScrollV=true;                }            }        }    },    indexLink:function(elementClass){//链接判断        var appType=elementClass.attr('appType');        var commonId=elementClass.attr('commonId');        if(appType==='5'){//专题列表            elementClass.attr('href',context+'/t-'+commonId);        }else if(appType==='1003'){//品牌页面            elementClass.attr('href',context+'/brand');        }else if(appType==='1007'){//商品详情页            elementClass.attr('href',context+'/product.sc?productid='+commonId);        }else if(appType==='1005'){//分类一级页面            elementClass.attr('href',context+'/fenlei');        }else if(appType==='1006'){//分类二级页面            elementClass.attr('href',context+'/fenlei-'+commonId);        }else if(appType==='1008'){//购物车页            elementClass.attr('href',context+'/shoppingcart');        }else if(appType==='1001'){//查看物流            elementClass.attr('href',context+'/my/listOrderLogistics.sc');        }else if(appType==='1024'){//频道页            elementClass.attr('href',context+'/showChannel.sc?channelId='+commonId);        }else if(appType==='1023'){//会员中心            elementClass.attr('href',context+'/mc.sc');        }else if(appType==='22'){//我的优购            elementClass.attr('href',context+'/my/myIndex.sc');        }else if(appType==='1014'){//我的订单            elementClass.attr('href',context+'/my/myorderlist.sc');        }else if(appType==='1015'){//我的收藏            elementClass.attr('href',context+'/my/listMyFavorites.sc');        }else if(appType==='1011'){//我的收藏            elementClass.attr('href',context+'/my/listOrderLogistics.sc');        }    },    scrollGet:function(){//频道导航固定        var offsetTopV=$('.ygIndexNav').offset().top;        var scrollTopV=$(window).scrollTop();        if(scrollTopV>=offsetTopV){            if(!$('#ygIndexNavW').hasClass('ygIndexNavWfix')){                $('#ygIndexNavW').addClass('ygIndexNavWfix');            }        }else{            if($('#ygIndexNavW').hasClass('ygIndexNavWfix')){                $('#ygIndexNavW').removeClass('ygIndexNavWfix');            }        }    },    IndexImg:function(elementW){//解决轮播首次加载高度问题        var swiperL=$('.ygSwiperCon .SwiperImg').length;        if($(elementW).hasClass('SwiperImg')){            if(ygIndexF.swiperLoad===0){                $('.ygSwiperCon').css('height','auto');            }            ygIndexF.swiperLoad++;        }        //console.log(ygIndexF.swiperLoad+'--'+swiperL)        if(ygIndexF.swiperLoad==swiperL){            ygIndex.indexSwiperF();        }        if($(elementW).parents('.ygIndexSection').hasClass('ygIndexSectionddd')){            $(elementW).parents('.ygIndexSection').removeClass('ygIndexSectionddd');        }    },    ygTopImgF:function(imgWrap,offWrap){//顶部banner        if($(imgWrap).length>0 && $(imgWrap).height()!=0){            var imgHeight=$(imgWrap).height();            $(imgWrap).css('height',0);            $(imgWrap).animate({                height:imgHeight+'px',                opacity: 1},                600, function() {            });            $(offWrap).on('click',function(){                $(imgWrap).animate({                    height:'0',                    opacity: 0},                    600, function() {                });            })        }    },    ygIndexNavF:function(){//频道滑动效果        var ygindexNav;        var widthV=0;        var ygindexL=$('#ygIndexNavUl li').length;        for(var i=0;i<ygindexL;i++){            var elementW=Math.ceil($('#ygIndexNavUl li').eq(i).width());            if(widthV!=0){                widthV=widthV+elementW;            }else{                widthV=elementW;            }        }        $('#scroller').css('width',(widthV+ygindexL)+'px');        ygindexNav = new IScroll('#ygIndexNavW', { scrollX: true, scrollY: false, mouseWheel: true, click: true });        $('#ygIndexNavUl li').click(function(){            var index=$(this).index();            var iscrollName='#ygIndexNavUl li:nth-child('+(index+1)+')';            $(this).addClass('shover').siblings().removeClass('shover');            ygindexNav.scrollToElement(document.querySelector(iscrollName),300,true);            //$('.rightContent').hide().eq(index).show();            ygindexNav.refresh();        })        $('#ygIndexNavUl li').each(function(){        if($(this).hasClass('shover')){                var index=$(this).index();                var shove='#ygIndexNavUl li:nth-child('+(index+1)+')';                ygindexNav.scrollToElement(document.querySelector(shove),300,true)            }        });    },    indexSwiperF:function(){//首页轮播效果        var mySwiper = new Swiper('.ygSwiperCon',{            pagination:'.ygPagination',            loop:true,            paginationClickable: true,            autoplay : 5000,            autoplayDisableOnInteraction : false        })        var mySwiperNumb1 = new Swiper('.ygSwiperNew',{            loop:true,            mode: 'vertical',            paginationClickable: false,            autoplay : 4000,            noSwiping : true,            autoplayDisableOnInteraction : false        })    },    indexSeacher:function(){//搜索弹窗        $('#ygIndexTopS').focus(function(){            seachIn();        });        $('.ygIndexTopL').click(function(){            if($('.ygIndexTop').hasClass('ygIndexTopShow')){                $('#ygIndexContent').show();                $('#indexSeacher').hide();                $('.ygIndexMenu').show();                $('.ygIndexTop').removeClass('ygIndexTopShow');                $('#ygIndexTopS').val('');                $('.ygIndexTopSub').addClass('ygIndexTopSubNo');                ygIndexF.scrollGet();            }            $('.ygIndexTopSub').on('click',function(){                seachIn();                $('#ygIndexTopS').focus();                _hmt.push(['_trackEvent', '搜索页，搜索按钮', 'click', 'seacherSubmit']);                return false;            })        });        $('.ygIndexTopSub').on('click',function(){            seachIn();            $('#ygIndexTopS').focus();            _hmt.push(['_trackEvent', '搜索页，搜索按钮', 'click', 'seacherSubmit']);            return false;        })        function seachIn(){            $('#ygIndexContent').hide();            $('#indexSeacher').show();            $('.ygIndexMenu').hide();            $('.ygIndexTop').addClass('ygIndexTopShow');            $('.ygIndexTopSub').off('click');        }    }}